<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="flight_search_results" name="Flight Search Results">
        <t t-call="website.layout">
            <style>
                .recommended-flight {
    border-left: 4px solid #28a745 !important;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.recommended-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    z-index: 10;
}
                /* Standardize destination images */
.card-img-top {
    height: 700px; /* Set a fixed height */
    object-fit: cover; /* Make images cover the area without distortion */
    width: 100%; /* Make sure width is consistent */
}

/* Specifically for destination cards */
.destinations .card-img-top {
    height: 700px; /* You can adjust this value based on your preference */
}

/* For the flight deals section */
.flight-deals .card-img-top {
    height: 700px; /* You can adjust this value based on your preference */
}
                /* Palette de couleurs */
                :root {
                    --bleu-fonce: #1A237E;
                    --bleu-clair: #42A5F5;
                    --blanc: #FFFFFF;
                    --gris-clair: #E0E0E0;
                }

                /* Styles généraux */
                body {
                    font-family: 'Arial', sans-serif;


                /* Section Hero */
                .hero-section {
                    background-image: url('/travel_booking/static/img/wp2574287.webp');
                    background-size: cover;
                    background-position: center;
                    padding: 100px 0;
                    text-align: center;
                    color: var(--blanc);
                }
                .hero-section h1 {
                    font-size: 3.5rem;
                    margin-bottom: 20px;
                    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
                }
                .hero-section .card {
                    background-color: rgba(255, 255, 255, 0.9);
                    padding: 30px;
                    border-radius: 15px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
                }
                .hero-section .form-label {
                    font-weight: bold;
                    color: var(--bleu-fonce);
                }
                .hero-section .btn-primary {
                    background-color: var(--bleu-clair);
                    border: none;
                    padding: 10px 20px;
                    font-size: 1.2rem;
                    color: var(--blanc);
                    transition: background-color 0.3s ease;
                }
                .hero-section .btn-primary:hover {
                    background-color: var(--bleu-fonce);
                }

                /* Section Pourquoi nous choisir */
                .why-choose-us {
                    background-color: var(--blanc);
                    padding: 80px 0;
                    text-align: center;
                }
                .why-choose-us h2 {
                    font-size: 2.5rem;
                    margin-bottom: 20px;
                    color: var(--bleu-fonce);
                }
                .why-choose-us .icon-box {
                    background: var(--gris-clair);
                    padding: 30px;
                    border-radius: 10px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                    margin-bottom: 20px;
                    transition: transform 0.3s ease;
                }
                .why-choose-us .icon-box:hover {
                    transform: translateY(-10px);
                }
                .why-choose-us .icon-box i {
                    font-size: 2.5rem;
                    color: var(--bleu-clair);
                    margin-bottom: 15px;
                }
                .why-choose-us .icon-box h3 {
                    font-size: 1.5rem;
                    color: var(--bleu-fonce);
                    margin-bottom: 10px;
                }
                .why-choose-us .icon-box p {
                    font-size: 1rem;
                    color: var(--bleu-fonce);
                }

                /* Section Avantages */
                .benefits-section {
                    background-color: var(--gris-clair);
                    padding: 80px 0;
                    text-align: center;
                }
                .benefits-section h2 {
                    font-size: 2.5rem;
                    margin-bottom: 20px;
                    color: var(--bleu-fonce);
                }
                .benefits-section .icon-box {
                    background: var(--blanc);
                    padding: 30px;
                    border-radius: 10px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                    margin-bottom: 20px;
                    transition: transform 0.3s ease;
                }
                .benefits-section .icon-box:hover {
                    transform: translateY(-10px);
                }
                .benefits-section .icon-box i {
                    font-size: 2.5rem;
                    color: var(--bleu-clair);
                    margin-bottom: 15px;
                }
                .benefits-section .icon-box h3 {
                    font-size: 1.5rem;
                    color: var(--bleu-fonce);
                    margin-bottom: 10px;
                }
                .benefits-section .icon-box p {
                    font-size: 1rem;
                    color: var(--bleu-fonce);
                }

                /* Section Témoignages */
                .testimonial-section {
                    background-color: var(--blanc);
                    padding: 80px 0;
                    text-align: center;
                }
                .testimonial-section h2 {
                    font-size: 2.5rem;
                    margin-bottom: 20px;
                    color: var(--bleu-fonce);
                }
                .testimonial-section .testimonial-card {
                    background: var(--gris-clair);
                    padding: 30px;
                    border-radius: 10px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                    margin-bottom: 20px;
                }
                .testimonial-section .testimonial-card img {
                    border-radius: 50%;
                    width: 80px;
                    height: 80px;
                    margin-bottom: 15px;
                }
                .testimonial-section .testimonial-card h3 {
                    font-size: 1.5rem;
                    color: var(--bleu-fonce);
                    margin-bottom: 10px;
                }
                .testimonial-section .testimonial-card p {
                    font-size: 1rem;
                    color: var(--bleu-fonce);
                }

                /* Section Call to Action */
                .cta-section {
                    background-color: var(--bleu-fonce);
                    padding: 80px 0;
                    text-align: center;
                    color: var(--blanc);
                }
                .cta-section h2 {
                    font-size: 2.5rem;
                    margin-bottom: 20px;
                }
                .cta-section p {
                    font-size: 1.2rem;
                    margin-bottom: 30px;
                }
                .cta-section .btn {
                    background-color: var(--bleu-clair);
                    color: var(--blanc);
                    font-size: 1.2rem;
                    padding: 10px 30px;
                    border-radius: 25px;
                    transition: background-color 0.3s ease, color 0.3s ease;
                }
                .cta-section .btn:hover {
                    background-color: var(--blanc);
                    color: var(--bleu-fonce);
                }
            </style>
            <div class="container mt-4">
                <div class="row">
                    <div class="col-12">
                        <h2>Résultats de recherche de vols</h2>

                        <!-- Détails de la recherche -->
                        <div class="card mb-4">
                            <div class="card-body">
                                <h5 class="card-title">Détails de votre recherche</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <strong>Type:</strong>
                                        <span t-if="search_params.get('trip_type') == 'OneWay'">Aller simple</span>
                                        <span t-if="search_params.get('trip_type') == 'RoundTrip'">Aller-retour</span>
                                        <span t-if="search_params.get('trip_type') == 'MultiCity'">Multi-destinations</span>
                                    </div>
                                    <div class="col-md-3">
                                        <strong>De:</strong> <span t-esc="search_params.get('departure_id')"/>
                                    </div>
                                    <div class="col-md-3">
                                        <strong>À:</strong> <span t-esc="search_params.get('destination_id')"/>
                                    </div>
                                    <div class="col-md-3">
                                        <strong>Date aller:</strong> <span t-esc="search_params.get('travel_date')"/>
                                    </div>
                                    <div t-if="search_params.get('trip_type') == 'RoundTrip'" class="col-md-3">
                                        <strong>Date retour:</strong> <span t-esc="search_params.get('return_date')"/>
                                    </div>
                                    <div class="col-md-3">
                                        <strong>child_count:</strong> <span t-esc="search_params.get('child_count', 0)"/>
                                    </div>
                                    <div class="col-md-3">
                                        <strong>adult_count:</strong> <span t-esc="search_params.get('adult_count', 1)"/>
                                    </div>
                                    <div class="col-md-3">
                                        <strong>infant_count:</strong> <span t-esc="search_params.get('infant_count', 0)"/>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tableau des résultats -->
                        <!-- Tableau des résultats -->
<div t-if="flights and flights.get('response', {}).get('flights')" class="table-responsive">
    <!-- Affichage des vols aller -->
    <h3 class="mb-3">Vols aller</h3>
    <table class="table table-hover">
        <thead>
            <tr>
                <th>Type</th>
                <th>Compagnie</th>
                <th>Vol</th>
                <th>Départ</th>
                <th>Arrivée</th>
                <th>Durée</th>
                <th>Prix</th>
                <th>Bagages</th>
                <th>Places</th>
                <th>Recommandé</th>
                <th>Score</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <t t-foreach="flights.get('response', {}).get('flights', [])" t-as="flight">
                <t t-if="not flight.get('isReturn', False)">
                    <tr t-att-class="flight.get('is_recommended', False) and 'table-success' or ''">
                        <td><span class="badge bg-primary">Aller</span></td>
                        <td><t t-esc="flight.get('airlines', {}).get('full', '')"/></td>
                        <td><t t-esc="flight.get('flightNumber', '')"/></td>
                        <td>
                            <div><t t-esc="flight.get('departDateTime', {}).get('time', '')"/></div>
                            <small class="text-muted"><t t-esc="flight.get('departDateTime', {}).get('date', '')"/></small>
                        </td>
                        <td>
                            <div><t t-esc="flight.get('arrivalDateTime', {}).get('time', '')"/></div>
                            <small class="text-muted"><t t-esc="flight.get('arrivalDateTime', {}).get('date', '')"/></small>
                        </td>
                        <td><t t-esc="flight.get('duration', '')"/></td>
                        <td><strong><t t-esc="flight.get('price', '')"/> <t t-esc="flight.get('currency', 'EUR')"/></strong></td>
                        <td><t t-esc="flight.get('baggageWeight', '')"/> <t t-esc="flight.get('baggageUnit', '')"/></td>
                        <td><t t-esc="flight.get('seatsRemaining', '')"/></td>
                        <td>
                            <t t-if="flight.get('is_recommended', False)">
                                <span class="badge bg-success">
                                    <i class="fa fa-thumbs-up me-1"></i> Recommandé
                                </span>
                            </t>
                        </td>
                        <td>
                            <t t-if="flight.get('recommendation_score') is not None">
                                <div class="progress" style="height: 10px; width: 100px;">
                                    <div class="progress-bar" role="progressbar" t-att-style="'width: ' + str(int(flight.get('recommendation_score', 0) * 100)) + '%'"
                                         t-att-aria-valuenow="int(flight.get('recommendation_score', 0) * 100)"
                                         aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <small class="d-block text-center mt-1"><t t-esc="int(flight.get('recommendation_score', 0) * 100)"/>%</small>
                            </t>
                        </td>
                        <td>
                            <form t-attf-action="/travel/booking/#{flight.get('id', '')}" method="post">
                                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                <input type="hidden" name="flight_number" t-att-value="flight.get('flightNumber', '')"/>
                                <input type="hidden" name="departure_time" t-att-value="flight.get('departDateTime', {}).get('time', '')"/>
                                <input type="hidden" name="departure_date" t-att-value="flight.get('departDateTime', {}).get('date', '')"/>
                                <input type="hidden" name="arrival_time" t-att-value="flight.get('arrivalDateTime', {}).get('time', '')"/>
                                <input type="hidden" name="arrival_date" t-att-value="flight.get('arrivalDateTime', {}).get('date', '')"/>
                                <input type="hidden" name="airline" t-att-value="flight.get('airlines', {}).get('full', '')"/>
                                <input type="hidden" name="price" t-att-value="flight.get('price', '')"/>
                                <input type="hidden" name="currency" t-att-value="flight.get('currency', 'EUR')"/>
                                <input type="hidden" name="baggage" t-att-value="flight.get('baggageWeight', '')"/>
                                <input type="hidden" name="adult_count" t-att-value="search_params.get('adult_count', 1)"/>
                                <input type="hidden" name="child_count" t-att-value="search_params.get('child_count', 0)"/>
                                <input type="hidden" name="infant_count" t-att-value="search_params.get('infant_count', 0)"/>
                                <input type="hidden" name="is_return" t-att-value="'false'"/>
                                <input type="hidden" name="is_recommended" t-att-value="'true' if flight.get('is_recommended', False) else 'false'"/>
                                <input type="hidden" name="recommendation_score" t-att-value="flight.get('recommendation_score', 0)"/>
                                <button type="submit" class="btn btn-primary">Réserver</button>
                            </form>
                        </td>
                    </tr>
                </t>
            </t>
        </tbody>
    </table>

    <!-- Affichage des vols retour uniquement si c'est un aller-retour -->
    <t t-if="search_params.get('trip_type') == 'RoundTrip'">
        <h3 class="mt-5 mb-3">Vols retour</h3>
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>Type</th>
                    <th>Compagnie</th>
                    <th>Vol</th>
                    <th>Départ</th>
                    <th>Arrivée</th>
                    <th>Durée</th>
                    <th>Prix</th>
                    <th>Bagages</th>
                    <th>Places</th>
                    <th>Recommandé</th>
                    <th>Score</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <t t-foreach="flights.get('response', {}).get('flights', [])" t-as="flight">
                    <t t-if="flight.get('isReturn', False)">
                        <tr t-att-class="flight.get('is_recommended', False) and 'table-success' or ''">
                            <td><span class="badge bg-secondary">Retour</span></td>
                            <td><t t-esc="flight.get('airlines', {}).get('full', '')"/></td>
                            <td><t t-esc="flight.get('flightNumber', '')"/></td>
                            <td>
                                <div><t t-esc="flight.get('departDateTime', {}).get('time', '')"/></div>
                                <small class="text-muted"><t t-esc="flight.get('departDateTime', {}).get('date', '')"/></small>
                            </td>
                            <td>
                                <div><t t-esc="flight.get('arrivalDateTime', {}).get('time', '')"/></div>
                                <small class="text-muted"><t t-esc="flight.get('arrivalDateTime', {}).get('date', '')"/></small>
                            </td>
                            <td><t t-esc="flight.get('duration', '')"/></td>
                            <td><strong><t t-esc="flight.get('price', '')"/> <t t-esc="flight.get('currency', 'EUR')"/></strong></td>
                            <td><t t-esc="flight.get('baggageWeight', '')"/> <t t-esc="flight.get('baggageUnit', '')"/></td>
                            <td><t t-esc="flight.get('seatsRemaining', '')"/></td>
                            <td>
                                <t t-if="flight.get('is_recommended', False)">
                                    <span class="badge bg-success">
                                        <i class="fa fa-thumbs-up me-1"></i> Recommandé
                                    </span>
                                </t>
                            </td>
                            <td>
                                <t t-if="flight.get('recommendation_score') is not None">
                                    <div class="progress" style="height: 10px; width: 100px;">
                                        <div class="progress-bar" role="progressbar" t-att-style="'width: ' + str(int(flight.get('recommendation_score', 0) * 100)) + '%'"
                                             t-att-aria-valuenow="int(flight.get('recommendation_score', 0) * 100)"
                                             aria-valuemin="0" aria-valuemax="100">
                                        </div>
                                    </div>
                                    <small class="d-block text-center mt-1"><t t-esc="int(flight.get('recommendation_score', 0) * 100)"/>%</small>
                                </t>
                            </td>
                            <td>
                                <form t-attf-action="/travel/booking/#{flight.get('id', '')}" method="post">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                    <input type="hidden" name="flight_number" t-att-value="flight.get('flightNumber', '')"/>
                                    <input type="hidden" name="departure_time" t-att-value="flight.get('departDateTime', {}).get('time', '')"/>
                                    <input type="hidden" name="departure_date" t-att-value="flight.get('departDateTime', {}).get('date', '')"/>
                                    <input type="hidden" name="arrival_time" t-att-value="flight.get('arrivalDateTime', {}).get('time', '')"/>
                                    <input type="hidden" name="arrival_date" t-att-value="flight.get('arrivalDateTime', {}).get('date', '')"/>
                                    <input type="hidden" name="airline" t-att-value="flight.get('airlines', {}).get('full', '')"/>
                                    <input type="hidden" name="price" t-att-value="flight.get('price', '')"/>
                                    <input type="hidden" name="currency" t-att-value="flight.get('currency', 'EUR')"/>
                                    <input type="hidden" name="baggage" t-att-value="flight.get('baggageWeight', '')"/>
                                    <input type="hidden" name="adult_count" t-att-value="search_params.get('adult_count', 1)"/>
                                    <input type="hidden" name="child_count" t-att-value="search_params.get('child_count', 0)"/>
                                    <input type="hidden" name="infant_count" t-att-value="search_params.get('infant_count', 0)"/>
                                    <input type="hidden" name="is_return" t-att-value="'true'"/>
                                    <input type="hidden" name="is_recommended" t-att-value="'true' if flight.get('is_recommended', False) else 'false'"/>
                                    <input type="hidden" name="recommendation_score" t-att-value="flight.get('recommendation_score', 0)"/>
                                    <button type="submit" class="btn btn-primary">Réserver</button>
                                </form>
                            </td>
                        </tr>
                    </t>
                </t>

            </tbody>
        </table>
    </t>
</div>

                        <!-- Message si aucun vol trouvé -->
                        <div t-if="not flights or not flights.get('response', {}).get('flights')" class="alert alert-info">
                            Aucun vol trouvé pour ces critères de recherche.
                        </div>

                        <!-- Bouton retour -->
                        <div class="mt-4">
                            <a href="/travel" class="btn btn-secondary">Retour à la recherche</a>
                        </div>
                    </div>
                </div>
            <section class="destinations py-5 bg-light">
                <div class="container">
                    <div class="text-center mb-5">
                        <img src="/travel_booking/static/img/Fly.png" class="img-fluid mb-3" alt="FlyNow Logo" style="max-width: 150px;"/>
                        <h2 class="display-5">TRAVEL <span class="bg-dark text-white px-2">ALL</span> <span class="bg-dark text-white px-2">OVER</span></h2>
                        <h2 class="display-5"><span class="bg-light text-primary px-2">The</span></h2>
                        <h2 class="display-5"><span class="bg-light text-primary px-2">WORLD</span></h2>
                        <div class="mt-3">
                            <a href="#" class="btn btn-primary">Booking Now</a>
                        </div>
                    </div>
                    <div class="position-relative">
                        <div class="row justify-content-center">
                            <div class="col-md-6 text-center">
                                <div class="card shadow-lg mb-4">
                                    <img src="/travel_booking/static/img/dubai2.jpg" class="card-img-top" alt="Dubai"/>
                                    <div class="card-body">
                                        <h3>Dubai</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card shadow mb-4">
                                    <img src="/travel_booking/static/img/paris.jpg" class="card-img-top" alt="Paris"/>
                                    <div class="card-body">
                                        <h5>Paris</h5>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card shadow mb-4">
                                    <img src="/travel_booking/static/img/italyy.jpg" class="card-img-top" alt="Italy"/>
                                    <div class="card-body">
                                        <h5>Italy</h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Flight path would be implemented with CSS dashed lines -->
                    </div>
                </div>
            </section>

            <!-- Statistics and CTA -->
            <section class="stats-section py-5">
                <div class="container">
                    <div class="card shadow-sm">
                        <div class="card-body p-4">
                            <div class="row align-items-center">
                                <div class="col-lg-6">
                                    <p class="text-primary mb-2">Achievement</p>
                                    <h2 class="mb-3">Your Destination Awaits, Book Now</h2>
                                    <p class="text-muted mb-4">Join thousands of satisfied travelers who have discovered their dream destinations with FlyNow.</p>
                                    <div class="row mb-4">
                                        <div class="col-md-6">
                                            <div class="d-flex align-items-center">
                                                <div class="icon-circle bg-primary-light rounded-circle p-3 me-3">
                                                    <i class="fa fa-users text-primary fa-lg"></i>
                                                </div>
                                                <div>
                                                    <h3 class="text-primary mb-0">12870+</h3>
                                                    <p class="mb-0">Happy Customers</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="d-flex align-items-center">
                                                <div class="icon-circle bg-primary-light rounded-circle p-3 me-3">
                                                    <i class="fa fa-check-circle text-primary fa-lg"></i>
                                                </div>
                                                <div>
                                                    <h3 class="text-primary mb-0">100%</h3>
                                                    <p class="mb-0">Client Satisfied</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center">
                                        <p class="mb-0 me-3">Let's Connect Reach Out for More Information</p>
                                        <a href="#" class="btn btn-primary">Contact us</a>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <img src="/travel_booking/static/img/images1234.jpg" class="img-fluid rounded" alt="Passenger"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
                <script>
                    const parseResults = (data) => {
  try {
    const results = typeof data === 'string' ? JSON.parse(data) : data;
    // Vérifier si les résultats sont dans le format attendu
    return results?.response?.flights || [];
  } catch (error) {
    console.error('Error parsing flight results:', error);
    return [];
  }
};
                </script>
            </div>

        </t>
    </template>
</odoo>